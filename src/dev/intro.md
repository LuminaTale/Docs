# 引擎架构与开发

欢迎来到 LuminaTale 的核心部分！🔧

本章将剥开引擎的外壳，深入探讨其内部构造。如果你想了解 Viviscript 是如何被解析的、渲染器是如何通过 GPU 绘制画面的，或者想为引擎贡献新的功能，这里就是你的起点。

## 预备知识

阅读本章内容，建议你具备以下基础：
- **Rust 语言基础**：理解所有权、生命周期、Trait 以及并发原语（`Arc`, `Mutex`）。
- **图形学概念**：了解基本的渲染循环、纹理、Shader 以及坐标系。
- **编译原理入门**：知道什么是词法分析 (Lexing)、语法分析 (Parsing) 和抽象语法树 (AST)。

## 开发哲学

LuminaTale 的架构设计遵循以下原则：
1.  **逻辑与渲染分离**：`lumina-core` 负责纯逻辑计算，不依赖任何具体的图形库；`lumina-skia-renderer` 负责将逻辑状态可视化。两者通过**事件队列**通信。
2.  **数据驱动**：所有的游戏行为都由数据（脚本 AST、配置、资源文件）驱动。
3.  **模块化**：各个 Crate 职责单一，尽量减少耦合。这是为了方便加入更多的功能。
4. **少造轮子**：一方面是因为 Galgame 这类游戏不需要太复杂的功能，并且在一开始写这个引擎时也是我为了锻炼自己对于底层和设计的能力，所以在只需要一个小功能时，尽量不要引入外部的轮子。

但是同样的，这些原则导致了架构设计上可能存在一些问题，在设计之初确实也存在很多没有考虑到的点，所以也非常欢迎各位仁人志士在 issue 中提出你的观点和想法。